<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes Application</title>
</head>
<style>
    /* * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    } */

    nav {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 20px auto;
        background-color: black;
        width: 400px;
        padding: 12px 24px;
        border-radius: 34px;


        a {
            text-decoration: none;
            color: white;
            padding: 8px 24px;
            font-family: sans-serif;
            transition: all .3s ease;
            margin: 0px 5px;
            border: 2px solid transparent;
        }

        a:hover {
            border: 2px solid gray;
            transition: all .3s ease;
            background-color: white;
            color: black;
            border-radius: 24px;
            box-shadow: inset 0px 5px 10px gray, inset 0px -5px 10px rgb(78, 78, 78);
        }

        a.active {
            border: 2px solid gray;
            transition: all .3s ease;
            background-color: white;
            color: black;
            border-radius: 24px;
            box-shadow: inset 0px 5px 10px gray, inset 0px -5px 10px rgb(78, 78, 78);
        }
    }

    .allNotes {
        /* background-color: red; */
        width: 90%;
        margin: auto;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        gap: 10px;
        padding: 20px;

        .note {
            background-color: transparent;
            width: 300px;
            height: 200px;
            padding: 5px 10px;
            border-radius: 12px;
            color: black;
            display: flex;
            justify-content: start;
            flex-direction: column;
            border: 2px solid gray;
            box-shadow: 5px 5px 0px gray;
            transition: all .3s ease;
            cursor: pointer;

            &.note:hover {
                transition: all .3s ease;
                box-shadow: 0px 0px 0px transparent;
                transform: translate(5px, 5px);
            }

            h2 {
                font-family: sans-serif;
                font-weight: 600;
            }

            p {
                color: rgb(95, 95, 95);
                font-family: sans-serif;
                font-size: 14px;
            }

            #noteID {
                color: rgba(48, 37, 37, 0.767);
                font-weight: 100;
            }
        }
    }

    dialog::backdrop {
        backdrop-filter: blur(10px);
    }

    #updateBox {
        width: 400px;
        height: 300px;
        border: 2px solid gray;

        h1 {
            text-align: center;
            font-family: sans-serif;
        }

        form {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            height: 80%;
            gap: 10px;

            input {
                width: 80%;
                height: 35px;
                box-shadow: 5px 5px 0px gray;
                outline: none;
                padding: 0px 12px;
                transition: all .2s ease;
                margin-bottom: 10px;
            }

            input:focus {
                transition: all .2s ease;
                transform: translate(5px, 5px);
                box-shadow: 0px 0px 0px transparent;
            }

            button {
                width: 90%;
                height: 40px;
                background: transparent;
                border: 2px solid gray;
                transition: all .3s ease;
                cursor: pointer;

                &#updateBTN:hover {
                    transition: all .3s ease;
                    background-color: rgb(84, 180, 84);
                    color: rgb(2, 85, 2);
                    border: 2px solid rgb(84, 180, 84);
                }

                &#cancelBTN:hover {
                    transition: all .3s ease;
                    background-color: rgb(138, 138, 138);
                    color: rgb(238, 238, 238);
                    border: 2px solid rgb(138, 138, 138);
                }
            }
        }
    }

    #deleteBTN:hover {
        transition: all .3s ease;
        background-color: rgb(187, 104, 104);
        color: rgb(71, 3, 3);
        border: 2px solid rgb(187, 104, 104);
    }
</style>

<body>
    <nav>
        <a href="http://localhost:9090/" class="active">Home</a>
        <a href="http://localhost:9090/note/newnote">New Note</a>
        <a href="http://localhost:9090/api/allnotes">JSON</a>
    </nav>

    <div class="allNotes">
        <% notes.forEach(n=> { %>
            <div class="note" data-id="<%= n._id %>">
                <h2 class="title">
                    <%= n.note %>
                </h2>
                <p class="desc">
                    <%= n.Description %>
                </p>
            </div>
            <% }) %>
    </div>
    <dialog id="updateBox">
        <h1>Update Note</h1>
        <form action="/note/updatenote" method="POST">
            <input type="hidden" id="noteId" name="id">
            <input type="text" id="noteInput" name="note">
            <input type="text" id="descInput" name="Description">
            <button type="submit" id="updateBTN">Update</button>
            <button onclick="document.getElementById('updateBox').close()" id="cancelBTN">Cancel</button>
        </form>
        <form action="/note/deletenote" method="POST">
            <h1 style="color: red;">Delete Your NOTE</h1>
            <input type="text" name="id" id="deleteID">
            <button type="submit" id="deleteBTN">Delete</button>
        </form>
    </dialog>
    <p>
        <% if (locals.msg) { %>
            <p>
                <%= msg %>
            </p>
            <% } %>
    </p>
    <script>
        let notes = document.querySelectorAll(".note");
        notes.forEach((card) => {
            card.addEventListener("click", () => {
                const id = card.dataset.id;
                const title = card.querySelector(".title").innerText;
                const desc = card.querySelector(".desc").innerText;
                document.getElementById("noteId").value = id;
                document.getElementById("deleteID").value = id;
                document.getElementById("noteInput").value = title;
                document.getElementById("descInput").value = desc;
                document.getElementById("updateBox").showModal();
            });
        });
    </script>
</body>

</html>